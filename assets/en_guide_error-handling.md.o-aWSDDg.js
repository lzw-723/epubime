import{_ as s,c as a,o as e,ah as r}from"./chunks/framework.BEBVyHNm.js";const c=JSON.parse('{"title":"Error Handling System","description":"","frontmatter":{},"headers":[],"relativePath":"en/guide/error-handling.md","filePath":"en/guide/error-handling.md"}'),n={name:"en/guide/error-handling.md"};function t(l,i,o,h,p,d){return e(),a("div",null,[...i[0]||(i[0]=[r(`<h1 id="error-handling-system" tabindex="-1">Error Handling System <a class="header-anchor" href="#error-handling-system" aria-label="Permalink to “Error Handling System”">​</a></h1><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to “Overview”">​</a></h2><p>We have successfully built a comprehensive error handling system for the EPUBime project, providing detailed error information, error recovery mechanisms, and flexible parsing options.</p><h2 id="core-components" tabindex="-1">Core Components <a class="header-anchor" href="#core-components" aria-label="Permalink to “Core Components”">​</a></h2><h3 id="_1-enhanced-exception-system" tabindex="-1">1. Enhanced Exception System <a class="header-anchor" href="#_1-enhanced-exception-system" aria-label="Permalink to “1. Enhanced Exception System”">​</a></h3><h4 id="epubparseexception-base-exception-class" tabindex="-1">EpubParseException (Base Exception Class) <a class="header-anchor" href="#epubparseexception-base-exception-class" aria-label="Permalink to “EpubParseException (Base Exception Class)”">​</a></h4><ul><li><p><strong>Error Code System</strong>: Standardized error codes (1000-9999 range)</p><ul><li>File-related errors: 1000-1999</li><li>ZIP-related errors: 2000-2999</li><li>XML parsing errors: 3000-3999</li><li>EPUB format errors: 4000-4999</li><li>Path validation errors: 5000-5999</li><li>Resource-related errors: 6000-6999</li><li>Generic errors: 9000-9999</li></ul></li><li><p><strong>Detailed Context Information</strong>:</p><ul><li>File name, file path, operation type</li><li>Line number, column number (XML parsing)</li><li>Custom context data</li><li>Recovery suggestions</li></ul></li><li><p><strong>Builder Pattern</strong>: Supports chain calls for building complex exceptions</p></li></ul><h4 id="specialized-exception-classes" tabindex="-1">Specialized Exception Classes <a class="header-anchor" href="#specialized-exception-classes" aria-label="Permalink to “Specialized Exception Classes”">​</a></h4><ul><li><strong>EpubZipException</strong>: ZIP file processing exceptions</li><li><strong>EpubXmlParseException</strong>: XML parsing exceptions with XPath and location information</li><li><strong>EpubFormatException</strong>: EPUB format validation exceptions</li><li><strong>EpubPathValidationException</strong>: Path security validation exceptions</li><li><strong>EpubResourceException</strong>: Resource loading exceptions</li></ul><h3 id="_2-error-context-collector-errorcontext" tabindex="-1">2. Error Context Collector (ErrorContext) <a class="header-anchor" href="#_2-error-context-collector-errorcontext" aria-label="Permalink to “2. Error Context Collector (ErrorContext)”">​</a></h3><ul><li><strong>Multi-level Error Recording</strong>: DEBUG, INFO, WARNING, ERROR, FATAL</li><li><strong>Thread Safety</strong>: Uses CopyOnWriteArrayList and ConcurrentHashMap</li><li><strong>Error Statistics</strong>: Detailed error counting and categorization</li><li><strong>Error Report Generation</strong>: Automatically generates structured error reports</li><li><strong>Maximum Error Limit</strong>: Prevents memory overflow</li><li><strong>Global Context</strong>: Supports adding global metadata</li></ul><h3 id="_3-parse-result-encapsulation-parseresult" tabindex="-1">3. Parse Result Encapsulation (ParseResult) <a class="header-anchor" href="#_3-parse-result-encapsulation-parseresult" aria-label="Permalink to “3. Parse Result Encapsulation (ParseResult)”">​</a></h3><ul><li><strong>Multi-status Support</strong>: SUCCESS, PARTIAL_SUCCESS, RECOVERED, FAILURE</li><li><strong>Performance Metrics</strong>: Parsing time statistics</li><li><strong>Error Summary</strong>: Contains all errors, warnings, and statistical information</li><li><strong>Builder Pattern</strong>: Flexible building approach</li></ul><h3 id="_4-parse-options-parseoptions" tabindex="-1">4. Parse Options (ParseOptions) <a class="header-anchor" href="#_4-parse-options-parseoptions" aria-label="Permalink to “4. Parse Options (ParseOptions)”">​</a></h3><ul><li><p><strong>Error Handling Strategies</strong>:</p><ul><li>STRICT: Strict mode, any error stops parsing</li><li>LENIENT: Lenient mode, recoverable errors continue parsing</li><li>BEST_EFFORT: Best effort mode, parse as much content as possible</li></ul></li><li><p><strong>Log Level Control</strong>: DEBUG, INFO, WARNING, ERROR, NONE</p></li><li><p><strong>Error Filtering</strong>: Supports ignoring specific error patterns</p></li><li><p><strong>Degradation Handling Configuration</strong>: Handling strategies for different error types</p></li></ul><h3 id="_5-error-recovery-configuration-parseerrorconfig" tabindex="-1">5. Error Recovery Configuration (ParseErrorConfig) <a class="header-anchor" href="#_5-error-recovery-configuration-parseerrorconfig" aria-label="Permalink to “5. Error Recovery Configuration (ParseErrorConfig)”">​</a></h3><ul><li><strong>Error Handling Strategies</strong>: STRICT, LENIENT, BEST_EFFORT</li><li><strong>Severity Threshold</strong>: Controls which level of errors cause parsing failure</li><li><strong>Maximum Error Limit</strong>: Prevents too many errors from affecting performance</li><li><strong>Degradation Handling</strong>: Supports skipping invalid resources and other degradation strategies</li></ul><h2 id="key-features" tabindex="-1">Key Features <a class="header-anchor" href="#key-features" aria-label="Permalink to “Key Features”">​</a></h2><h3 id="_1-detailed-error-information" tabindex="-1">1. Detailed Error Information <a class="header-anchor" href="#_1-detailed-error-information" aria-label="Permalink to “1. Detailed Error Information”">​</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>[3001: XML parsing failed] Invalid XML structure [File: content.opf, Path: OEBPS/content.opf, Operation: xmlParsing]</span></span></code></pre></div><h3 id="_2-error-recovery-mechanisms" tabindex="-1">2. Error Recovery Mechanisms <a class="header-anchor" href="#_2-error-recovery-mechanisms" aria-label="Permalink to “2. Error Recovery Mechanisms”">​</a></h3><ul><li>Automatic Recovery: For non-fatal errors, the system can attempt to continue parsing</li><li>Degradation Handling: Skip invalid parts and parse valid content</li><li>Flexible Configuration: Control recovery behavior through ParseOptions</li></ul><h3 id="_3-performance-optimization" tabindex="-1">3. Performance Optimization <a class="header-anchor" href="#_3-performance-optimization" aria-label="Permalink to “3. Performance Optimization”">​</a></h3><ul><li>Caching Mechanism: Avoid repeated parsing of the same file</li><li>Fast Failure: Serious errors terminate immediately, saving resources</li><li>Statistical Information: Provide detailed performance metrics</li></ul><h3 id="_4-security-enhancement" tabindex="-1">4. Security Enhancement <a class="header-anchor" href="#_4-security-enhancement" aria-label="Permalink to “4. Security Enhancement”">​</a></h3><ul><li>Path traversal attack detection</li><li>Malicious file format validation</li><li>Resource access permission checking</li></ul><h2 id="usage-examples" tabindex="-1">Usage Examples <a class="header-anchor" href="#usage-examples" aria-label="Permalink to “Usage Examples”">​</a></h2><h3 id="basic-exception-creation" tabindex="-1">Basic Exception Creation <a class="header-anchor" href="#basic-exception-creation" aria-label="Permalink to “Basic Exception Creation”">​</a></h3><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EpubParseException exception </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EpubParseException.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Builder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;XML parsing failed&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fileName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;content.opf&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">filePath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;OEBPS/content.opf&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">operation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;xmlParsing&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">errorCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(EpubParseException.ErrorCode.XML_PARSE_ERROR)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lineNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">columnNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addContext</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;xpath&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/package/metadata&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre></div><h3 id="error-context-usage" tabindex="-1">Error Context Usage <a class="header-anchor" href="#error-context-usage" aria-label="Permalink to “Error Context Usage”">​</a></h3><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ErrorContext errorContext </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ErrorContext</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ParseOptions.LogLevel.DEBUG);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">errorContext.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">warning</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Missing optional metadata&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;book.epub&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/metadata&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;metadataParsing&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    EpubParseException.ErrorCode.XML_MISSING_REQUIRED_ELEMENT, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="parse-result-handling" tabindex="-1">Parse Result Handling <a class="header-anchor" href="#parse-result-handling" aria-label="Permalink to “Parse Result Handling”">​</a></h3><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ParseResult result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ParseResult.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">partialSuccess</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(epubBook, errorContext, parseTime);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (result.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isPartialSuccess</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Parsing partially successful with warning messages&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    System.out.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(result.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getErrorStatistics</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="performance-metrics" tabindex="-1">Performance Metrics <a class="header-anchor" href="#performance-metrics" aria-label="Permalink to “Performance Metrics”">​</a></h2><ul><li><strong>Cache Efficiency</strong>: 99.5%+ performance improvement</li><li><strong>Parsing Speed</strong>: Average 6-10ms to complete EPUB parsing</li><li><strong>Memory Usage</strong>: Optimized error collection, prevents memory leaks</li><li><strong>Concurrency Safety</strong>: Thread-safe error collection mechanism</li></ul><h2 id="quality-assurance" tabindex="-1">Quality Assurance <a class="header-anchor" href="#quality-assurance" aria-label="Permalink to “Quality Assurance”">​</a></h2><ul><li><strong>Test Coverage</strong>: 111 test cases, all passed</li><li><strong>Code Quality</strong>: SpotBugs static analysis passed</li><li><strong>Performance Benchmark</strong>: Integrated JMH professional benchmarking, 55% parsing performance improvement compared to epublib</li><li><strong>Complete Documentation</strong>: Detailed JavaDoc and example code</li></ul><h2 id="summary" tabindex="-1">Summary <a class="header-anchor" href="#summary" aria-label="Permalink to “Summary”">​</a></h2><p>This enhanced error handling system provides EPUBime with:</p><ol><li><strong>Enterprise-level error handling capabilities</strong>: Detailed error information and recovery mechanisms</li><li><strong>Flexible configuration options</strong>: Adapt to different usage scenarios</li><li><strong>Excellent performance</strong>: Caching mechanisms and optimization strategies</li><li><strong>Comprehensive monitoring capabilities</strong>: Detailed statistics and reporting functions</li><li><strong>Strong security</strong>: Path validation and malicious file detection</li></ol><p>The system can now gracefully handle various EPUB parsing errors, provide useful error information, and automatically recover when possible, greatly improving user experience and system stability.</p>`,41)])])}const g=s(n,[["render",t]]);export{c as __pageData,g as default};
